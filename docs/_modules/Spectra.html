<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Spectra &#8212; py-SolarCalc 3.2 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">py-SolarCalc</a></h1>



<p class="blurb">Software for Temperature, Relative Humidity and Solar Spectral Modeling.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=borevitzlab&repo=pysolarcalc&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../light_sim.html">Light Sim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../light_sim.html#spectra">Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../light_sim.html#solarpos">SolarPos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../world_temp_sim.html">Temperature Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">General Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../py-modindex.html">Module Index</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for Spectra</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">Solarpos</span> <span class="k">import</span> <span class="n">Solarpos</span>
<span class="n">SPO</span> <span class="o">=</span> <span class="mf">1360.0</span>

<span class="n">DEGREES_TO_RADIANS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span>
<span class="n">RADIANS_TO_DEGREES</span> <span class="o">=</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">ONEMINUSEPSILON</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>


<div class="viewcode-block" id="Spectra"><a class="viewcode-back" href="../light_sim.html#Spectra.Spectra">[docs]</a><span class="k">class</span> <span class="nc">Spectra</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Units:</span>
<span class="sd">         1 = irradiance (W/sq m/micron) per wavelength (microns)</span>
<span class="sd">         2 = photon flux (10.0E+16 /sq cm/s/micron) perwavelength (microns)</span>
<span class="sd">         3 = photon flux density (10.0E+16 /sq cm/s/eV) per energy (eV)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># default values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minute</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hour</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aspect</span> <span class="o">=</span> <span class="mf">180.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span>

        <span class="c1"># default to 1998 because numbers.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="mi">2012</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dayofyear</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">press</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">longitude</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">sunset</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">sunrise</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">solarnoon</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">halfdaylength</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">group_multipliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

        <span class="c1"># Input reflectivities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spcrfl</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>
        <span class="c1"># Input reflectivity wavelengths</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spcwvr</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]</span>
        <span class="c1"># Power on Angstrom turbidity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.14</span>
        <span class="c1"># Aerosol assymetry factor (rural assumed)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assym</span> <span class="o">=</span> <span class="mf">0.65</span>
        <span class="c1"># Atmospheric ozone (cm) -1.0 = let S_spectral2 calculate it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ozone</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="c1"># Aerosol optical depth at 0.5 microns, base e</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau500</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="c1"># Precipitable water vapor (cm)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">watvap</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="c1"># aerosol asymmetry factor, rural assumed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assym</span> <span class="o">=</span> <span class="mf">0.65</span>

<div class="viewcode-block" id="Spectra.calc_ozone"><a class="viewcode-back" href="../light_sim.html#Spectra.Spectra.calc_ozone">[docs]</a>    <span class="k">def</span> <span class="nf">calc_ozone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculates ozone density?</span>

<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ozone</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c1</span> <span class="o">=</span> <span class="mf">100.0</span>
            <span class="n">c2</span> <span class="o">=</span> <span class="mf">1.5</span>
            <span class="n">c3</span> <span class="o">=</span> <span class="mf">30.0</span>
            <span class="n">c4</span> <span class="o">=</span> <span class="mf">152.625</span>
            <span class="n">c5</span> <span class="o">=</span> <span class="mf">2.0</span>
            <span class="n">c6</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.0</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">c1</span> <span class="o">=</span> <span class="mf">150.0</span>
                <span class="n">c2</span> <span class="o">=</span> <span class="mf">1.28</span>
                <span class="n">c3</span> <span class="o">=</span> <span class="mf">40.0</span>
                <span class="n">c4</span> <span class="o">=</span> <span class="o">-</span><span class="mf">30.0</span>
                <span class="n">c5</span> <span class="o">=</span> <span class="mf">3.0</span>
                <span class="n">c6</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">longitude</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">c6</span> <span class="o">=</span> <span class="mf">20.0</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.9865</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dayofyear</span> <span class="o">+</span> <span class="n">c4</span><span class="p">)</span> <span class="o">/</span> <span class="n">RADIANS_TO_DEGREES</span><span class="p">)</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">c5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> <span class="n">c6</span><span class="p">)</span> <span class="o">/</span> <span class="n">RADIANS_TO_DEGREES</span><span class="p">)</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">c2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">latitude</span> <span class="o">/</span> <span class="n">RADIANS_TO_DEGREES</span><span class="p">)</span>
            <span class="k">return</span> <span class="mf">0.235</span> <span class="o">+</span> <span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c3</span> <span class="o">*</span> <span class="n">s1</span> <span class="o">+</span> <span class="mf">20.0</span> <span class="o">*</span> <span class="n">s2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">s3</span> <span class="o">*</span> <span class="n">s3</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ozone</span></div>

<div class="viewcode-block" id="Spectra.calc_all_spectral"><a class="viewcode-back" href="../light_sim.html#Spectra.Spectra.calc_all_spectral">[docs]</a>    <span class="k">def</span> <span class="nf">calc_all_spectral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solar_irradiance</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculates the spectrum, integrated irradiation, spectral groups, total radiation, and total visible light</span>

<span class="sd">        BROKEN, spectra are NAN</span>

<span class="sd">        :param solar_irradiance: solar irradiance as calculated in light_sim.py</span>
<span class="sd">        :return: tuple of spectrum, integrated irradiation, spectral groups, total radiation, and total visible light</span>
<span class="sd">        :rtype: tuple[np.ndarray, np.ndarray, np.ndarray, float, float]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;units should be 1-3 not </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau500</span> <span class="o">&lt;=</span> <span class="mf">10.0</span><span class="p">),</span> <span class="s2">&quot;tau500 should be within 0.0 to 10.0&quot;</span>
        <span class="k">assert</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assym</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">),</span> <span class="s2">&quot;assym should be between 0 and 1&quot;</span>

        <span class="c1"># some magic numbers?</span>
        <span class="n">grp1high</span><span class="p">,</span> <span class="n">grp1low</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span>
        <span class="n">grp2high</span><span class="p">,</span> <span class="n">grp2low</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">25</span>
        <span class="n">grp3high</span><span class="p">,</span> <span class="n">grp3low</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">32</span>
        <span class="n">grp4high</span><span class="p">,</span> <span class="n">grp4low</span> <span class="o">=</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">38</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This array contains the extraterrestrial spectrum and atmospheric absorption coefficients at 122 wavelengths.</span>
<span class="sd">        0 = wavelength (microns)</span>
<span class="sd">        1 = extraterrestrial spectrum (W/sq m/micron)</span>
<span class="sd">        2 = water vapor absorption coefficient</span>
<span class="sd">        3 = ozone absorption coefficient</span>
<span class="sd">        4 = uniformly mixed gas &quot;absorption coefficient&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">wavelength_microns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.305</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.315</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.325</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.335</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.345</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span>
             <span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.593</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.63</span><span class="p">,</span>
             <span class="mf">0.656</span><span class="p">,</span> <span class="mf">0.6676</span><span class="p">,</span> <span class="mf">0.69</span><span class="p">,</span> <span class="mf">0.71</span><span class="p">,</span> <span class="mf">0.718</span><span class="p">,</span> <span class="mf">0.7244</span><span class="p">,</span> <span class="mf">0.74</span><span class="p">,</span> <span class="mf">0.7525</span><span class="p">,</span> <span class="mf">0.7575</span><span class="p">,</span> <span class="mf">0.7625</span><span class="p">,</span> <span class="mf">0.7675</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">0.8237</span><span class="p">,</span>
             <span class="mf">0.8315</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">,</span> <span class="mf">0.905</span><span class="p">,</span> <span class="mf">0.915</span><span class="p">,</span> <span class="mf">0.925</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">,</span> <span class="mf">0.937</span><span class="p">,</span> <span class="mf">0.948</span><span class="p">,</span> <span class="mf">0.965</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.9935</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.07</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span>
             <span class="mf">1.12</span><span class="p">,</span> <span class="mf">1.13</span><span class="p">,</span> <span class="mf">1.145</span><span class="p">,</span> <span class="mf">1.161</span><span class="p">,</span> <span class="mf">1.17</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mf">1.32</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mf">1.395</span><span class="p">,</span> <span class="mf">1.4425</span><span class="p">,</span> <span class="mf">1.462</span><span class="p">,</span> <span class="mf">1.477</span><span class="p">,</span> <span class="mf">1.497</span><span class="p">,</span>
             <span class="mf">1.52</span><span class="p">,</span> <span class="mf">1.539</span><span class="p">,</span> <span class="mf">1.558</span><span class="p">,</span> <span class="mf">1.578</span><span class="p">,</span> <span class="mf">1.592</span><span class="p">,</span> <span class="mf">1.61</span><span class="p">,</span> <span class="mf">1.63</span><span class="p">,</span> <span class="mf">1.646</span><span class="p">,</span> <span class="mf">1.678</span><span class="p">,</span> <span class="mf">1.74</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.86</span><span class="p">,</span> <span class="mf">1.92</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">1.985</span><span class="p">,</span> <span class="mf">2.005</span><span class="p">,</span>
             <span class="mf">2.035</span><span class="p">,</span> <span class="mf">2.065</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.148</span><span class="p">,</span> <span class="mf">2.198</span><span class="p">,</span> <span class="mf">2.27</span><span class="p">,</span> <span class="mf">2.36</span><span class="p">,</span> <span class="mf">2.45</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span>
             <span class="mf">3.6</span><span class="p">,</span> <span class="mf">3.7</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">,</span> <span class="mf">3.9</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">])</span>
        <span class="n">etr_spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">535.9</span><span class="p">,</span> <span class="mf">558.3</span><span class="p">,</span> <span class="mf">622.0</span><span class="p">,</span> <span class="mf">692.7</span><span class="p">,</span> <span class="mf">715.1</span><span class="p">,</span> <span class="mf">832.9</span><span class="p">,</span> <span class="mf">961.9</span><span class="p">,</span> <span class="mf">931.9</span><span class="p">,</span> <span class="mf">900.6</span><span class="p">,</span> <span class="mf">911.3</span><span class="p">,</span> <span class="mf">975.5</span><span class="p">,</span> <span class="mf">975.9</span><span class="p">,</span> <span class="mf">1119.9</span><span class="p">,</span> <span class="mf">1103.</span><span class="p">,</span> <span class="mf">1033.8</span><span class="p">,</span>
             <span class="mf">1479.1</span><span class="p">,</span> <span class="mf">1701.3</span><span class="p">,</span> <span class="mf">1740.4</span><span class="p">,</span> <span class="mf">1587.2</span><span class="p">,</span> <span class="mf">1837.0</span><span class="p">,</span> <span class="mf">2005.0</span><span class="p">,</span> <span class="mf">2043.0</span><span class="p">,</span> <span class="mf">1987.0</span><span class="p">,</span> <span class="mf">2027.0</span><span class="p">,</span> <span class="mf">1896.0</span><span class="p">,</span> <span class="mf">1909.0</span><span class="p">,</span> <span class="mf">1927.</span><span class="p">,</span> <span class="mf">1831.0</span><span class="p">,</span>
             <span class="mf">1891.0</span><span class="p">,</span> <span class="mf">1898.0</span><span class="p">,</span> <span class="mf">1892.0</span><span class="p">,</span> <span class="mf">1840.0</span><span class="p">,</span> <span class="mf">1768.0</span><span class="p">,</span> <span class="mf">1728.0</span><span class="p">,</span> <span class="mf">1658.0</span><span class="p">,</span> <span class="mf">1524.0</span><span class="p">,</span> <span class="mf">1531.0</span><span class="p">,</span> <span class="mf">1420.0</span><span class="p">,</span> <span class="mf">1399.0</span><span class="p">,</span> <span class="mf">1374.</span><span class="p">,</span> <span class="mf">1373.0</span><span class="p">,</span>
             <span class="mf">1298.0</span><span class="p">,</span> <span class="mf">1269.0</span><span class="p">,</span> <span class="mf">1245.0</span><span class="p">,</span> <span class="mf">1223.0</span><span class="p">,</span> <span class="mf">1205.0</span><span class="p">,</span> <span class="mf">1183.0</span><span class="p">,</span> <span class="mf">1148.0</span><span class="p">,</span> <span class="mf">1091.0</span><span class="p">,</span> <span class="mf">1062.0</span><span class="p">,</span> <span class="mf">1038.0</span><span class="p">,</span> <span class="mf">1022.0</span><span class="p">,</span> <span class="mf">998.</span><span class="p">,</span> <span class="mf">947.2</span><span class="p">,</span> <span class="mf">893.2</span><span class="p">,</span>
             <span class="mf">868.2</span><span class="p">,</span> <span class="mf">829.7</span><span class="p">,</span> <span class="mf">830.3</span><span class="p">,</span> <span class="mf">814.0</span><span class="p">,</span> <span class="mf">786.9</span><span class="p">,</span> <span class="mf">768.3</span><span class="p">,</span> <span class="mf">767.0</span><span class="p">,</span> <span class="mf">757.6</span><span class="p">,</span> <span class="mf">688.1</span><span class="p">,</span> <span class="mf">640.7</span><span class="p">,</span> <span class="mf">606.2</span><span class="p">,</span> <span class="mf">585.9</span><span class="p">,</span> <span class="mf">570.</span><span class="p">,</span> <span class="mf">564.1</span><span class="p">,</span> <span class="mf">544.2</span><span class="p">,</span>
             <span class="mf">533.4</span><span class="p">,</span> <span class="mf">501.6</span><span class="p">,</span> <span class="mf">477.5</span><span class="p">,</span> <span class="mf">442.7</span><span class="p">,</span> <span class="mf">440.0</span><span class="p">,</span> <span class="mf">416.8</span><span class="p">,</span> <span class="mf">391.4</span><span class="p">,</span> <span class="mf">358.9</span><span class="p">,</span> <span class="mf">327.5</span><span class="p">,</span> <span class="mf">317.5</span><span class="p">,</span> <span class="mf">307.3</span><span class="p">,</span> <span class="mf">300.4</span><span class="p">,</span> <span class="mf">292.</span><span class="p">,</span> <span class="mf">275.5</span><span class="p">,</span> <span class="mf">272.1</span><span class="p">,</span>
             <span class="mf">259.3</span><span class="p">,</span> <span class="mf">246.9</span><span class="p">,</span> <span class="mf">244.0</span><span class="p">,</span> <span class="mf">243.5</span><span class="p">,</span> <span class="mf">234.8</span><span class="p">,</span> <span class="mf">220.5</span><span class="p">,</span> <span class="mf">190.8</span><span class="p">,</span> <span class="mf">171.1</span><span class="p">,</span> <span class="mf">144.5</span><span class="p">,</span> <span class="mf">135.7</span><span class="p">,</span> <span class="mf">123.0</span><span class="p">,</span> <span class="mf">123.8</span><span class="p">,</span> <span class="mf">113.</span><span class="p">,</span> <span class="mf">108.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">,</span>
             <span class="mf">92.4</span><span class="p">,</span> <span class="mf">82.4</span><span class="p">,</span> <span class="mf">74.6</span><span class="p">,</span> <span class="mf">68.3</span><span class="p">,</span> <span class="mf">63.8</span><span class="p">,</span> <span class="mf">49.5</span><span class="p">,</span> <span class="mf">48.5</span><span class="p">,</span> <span class="mf">38.6</span><span class="p">,</span> <span class="mf">36.6</span><span class="p">,</span> <span class="mf">32.0</span><span class="p">,</span> <span class="mf">28.1</span><span class="p">,</span> <span class="mf">24.8</span><span class="p">,</span> <span class="mf">22.1</span><span class="p">,</span> <span class="mf">19.6</span><span class="p">,</span> <span class="mf">17.</span><span class="p">,</span> <span class="mf">15.7</span><span class="p">,</span> <span class="mf">14.1</span><span class="p">,</span> <span class="mf">12.7</span><span class="p">,</span>
             <span class="mf">11.5</span><span class="p">,</span> <span class="mf">10.4</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span> <span class="mf">8.6</span><span class="p">])</span>
        <span class="n">water_vapor_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.016</span><span class="p">,</span> <span class="mf">0.0125</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span>
             <span class="mf">0.061</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.0006</span><span class="p">,</span> <span class="mf">0.036</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.155</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.0026</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span>
             <span class="mf">5.0</span><span class="p">,</span> <span class="mf">27.0</span><span class="p">,</span> <span class="mf">55.0</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">1.48</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">115.0</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span>
             <span class="mf">0.1</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">185.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span>
             <span class="mf">0.036</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">130.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mf">310.0</span><span class="p">,</span>
             <span class="mf">15000.0</span><span class="p">,</span> <span class="mf">22000.0</span><span class="p">,</span> <span class="mf">8000.0</span><span class="p">,</span> <span class="mf">650.0</span><span class="p">,</span> <span class="mf">240.0</span><span class="p">,</span> <span class="mf">230.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">,</span> <span class="mf">19.5</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0045</span><span class="p">])</span>
        <span class="n">ozone_absorbtion_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.019</span><span class="p">,</span> <span class="mf">0.007</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">,</span> <span class="mf">0.009</span><span class="p">,</span> <span class="mf">0.01400</span><span class="p">,</span> <span class="mf">0.021</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.048</span><span class="p">,</span> <span class="mf">0.063</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">,</span> <span class="mf">0.085</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.119</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
             <span class="mf">0.065</span><span class="p">,</span> <span class="mf">0.051</span><span class="p">,</span> <span class="mf">0.028</span><span class="p">,</span> <span class="mf">0.018</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.012</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.007</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
        <span class="n">uniformly_mixed_gas_absorbtion_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
             <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.0002</span><span class="p">,</span> <span class="mf">0.00011</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span>
             <span class="mf">0.0006</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0014</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">,</span>
             <span class="mf">0.2</span><span class="p">,</span> <span class="mf">21.0</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.00038</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.00015</span><span class="p">,</span> <span class="mf">0.00014</span><span class="p">,</span> <span class="mf">0.00066</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">150.</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span>
             <span class="mf">0.0095</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.075</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.00195</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">])</span>

        <span class="n">c</span> <span class="o">=</span> <span class="mf">2.9979244e14</span>
        <span class="n">cons</span> <span class="o">=</span> <span class="mf">5.0340365e14</span>
        <span class="n">evolt</span> <span class="o">=</span> <span class="mf">1.6021891e-19</span>
        <span class="n">h</span> <span class="o">=</span> <span class="mf">6.6261762e-34</span>
        <span class="n">omeg</span> <span class="o">=</span> <span class="mf">0.945</span>
        <span class="n">omegp</span> <span class="o">=</span> <span class="mf">0.095</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">c</span> <span class="o">/</span> <span class="n">evolt</span>
        <span class="n">track</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span> <span class="o">&lt;</span> <span class="mi">0</span>
        <span class="n">solarpos</span> <span class="o">=</span> <span class="n">Solarpos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
                            <span class="n">dayofyear</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dayofyear</span><span class="p">,</span>
                            <span class="n">hour</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span>
                            <span class="n">minute</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span>
                            <span class="n">second</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">,</span>
                            <span class="n">timezone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timezone</span><span class="p">,</span>
                            <span class="n">tilt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tilt</span><span class="p">,</span>
                            <span class="n">temp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span>
                            <span class="n">aspect</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aspect</span>
                            <span class="p">)</span>
        <span class="c1"># spectra array</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">122</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="c1"># this array should function as the following 5</span>
        <span class="c1"># x-value</span>
        <span class="c1"># direct</span>
        <span class="c1"># extraterrestrial</span>
        <span class="c1"># diffuse</span>
        <span class="c1"># global</span>

        <span class="c1"># specx = np.zeros(122)</span>
        <span class="c1"># specdir = np.zeros(122) # direct spectrum</span>
        <span class="c1"># specetr = np.zeros(122) # extraterrestrial</span>
        <span class="c1"># specdif = np.zeros(122) # diffuse spectrum</span>
        <span class="c1"># specglo = np.zeros(122) # global spectrum</span>


        <span class="c1"># grps is for the following, sc.grp&lt;n&gt;, refgrp&lt;n&gt;, countgrp&lt;n&gt;, grp&lt;n&gt;shademult, grouplow, grouphigh, groupmuliplier</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
        <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">grp1low</span><span class="p">,</span> <span class="n">grp1high</span>
        <span class="n">groups</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">grp2low</span><span class="p">,</span> <span class="n">grp2high</span>
        <span class="n">groups</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">grp3low</span><span class="p">,</span> <span class="n">grp3high</span>
        <span class="n">groups</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">grp4low</span><span class="p">,</span> <span class="n">grp4high</span>
        <span class="n">groups</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_multipliers</span>

        <span class="c1"># these are represented in &#39;groups&#39;</span>
        <span class="c1"># output&lt;n&gt; (sc.grp&lt;n&gt;)</span>
        <span class="c1"># refgrp = np.zeros(4)</span>
        <span class="c1"># countgrp = np.zeros(4)</span>
        <span class="c1"># grpshademult</span>
        <span class="c1"># group multiplier, by default is 1.0</span>

        <span class="c1"># shading multiplier matrix, 0-36 = 0.1, 37-122 = 0.5</span>
        <span class="n">shadingmultiplier</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mf">0.5</span><span class="p">],</span> <span class="mi">122</span><span class="p">)</span>
        <span class="n">shadingmultiplier</span><span class="p">[:</span><span class="mi">37</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mf">0.1</span><span class="p">],</span> <span class="mi">37</span><span class="p">)</span>

        <span class="c1"># integration:</span>
        <span class="c1"># direct</span>
        <span class="c1"># diffuse</span>
        <span class="c1"># total</span>
        <span class="n">integration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">122</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">trad</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">totvis</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">solarpos</span><span class="o">.</span><span class="n">zenref</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sunrise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sunset</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">/</span> <span class="mi">60</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">solarpos</span><span class="o">.</span><span class="n">srss</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solarnoon</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">solarpos</span><span class="o">.</span><span class="n">srss</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">halfdaylength</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sunrise</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sunset</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">solarpos</span><span class="o">.</span><span class="n">cosinc</span>
            <span class="k">if</span> <span class="n">track</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span> <span class="o">=</span> <span class="n">solarpos</span><span class="o">.</span><span class="n">zenref</span>
                <span class="n">ci</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">solarpos</span><span class="o">.</span><span class="n">tilt</span> <span class="o">/</span> <span class="n">RADIANS_TO_DEGREES</span><span class="p">)</span>
            <span class="n">cz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">solarpos</span><span class="o">.</span><span class="n">zenref</span> <span class="o">/</span> <span class="n">RADIANS_TO_DEGREES</span><span class="p">)</span>
            <span class="n">O3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_ozone</span><span class="p">()</span>
            <span class="c1"># Equation 3-14</span>
            <span class="n">alg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">assym</span><span class="p">)</span>
            <span class="c1"># Equation 3-12</span>
            <span class="n">afs</span> <span class="o">=</span> <span class="n">alg</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.459</span> <span class="o">+</span> <span class="n">alg</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.1595</span> <span class="o">+</span> <span class="n">alg</span> <span class="o">*</span> <span class="mf">0.4129</span><span class="p">))</span>
            <span class="c1"># Equation 3-13</span>
            <span class="n">bfs</span> <span class="o">=</span> <span class="n">alg</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.0783</span> <span class="o">+</span> <span class="n">alg</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.3824</span> <span class="o">-</span> <span class="n">alg</span> <span class="o">*</span> <span class="mf">0.5874</span><span class="p">))</span>
            <span class="c1"># Equation 3-15</span>
            <span class="n">fsp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">afs</span> <span class="o">+</span> <span class="n">bfs</span> <span class="o">/</span> <span class="mf">1.8</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.8</span><span class="p">)</span>
            <span class="c1"># Equation 3-11</span>
            <span class="n">fs</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">afs</span> <span class="o">+</span> <span class="n">bfs</span> <span class="o">*</span> <span class="n">cz</span><span class="p">)</span> <span class="o">*</span> <span class="n">cz</span><span class="p">)</span>
            <span class="c1"># Ozone mass</span>
            <span class="n">ozone_mass</span> <span class="o">=</span> <span class="mf">1.003454</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">cz</span> <span class="o">*</span> <span class="n">cz</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.006908</span><span class="p">)</span>
            <span class="n">amass</span><span class="p">,</span> <span class="n">ampress</span><span class="p">,</span> <span class="n">erv</span> <span class="o">=</span> <span class="n">solarpos</span><span class="o">.</span><span class="n">amass</span><span class="p">,</span> <span class="n">solarpos</span><span class="o">.</span><span class="n">ampress</span><span class="p">,</span> <span class="n">solarpos</span><span class="o">.</span><span class="n">erv</span>
            <span class="n">tau500</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">watvap</span><span class="p">,</span> <span class="n">tilt</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau500</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">watvap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span>
            <span class="n">wvlrefl</span><span class="p">,</span> <span class="n">refl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spcwvr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spcrfl</span>
            <span class="n">nr</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="n">referf</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">totvis</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">122</span><span class="p">):</span>
                <span class="n">wvl</span> <span class="o">=</span> <span class="n">wavelength_microns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">etr</span> <span class="o">=</span> <span class="n">etr_spectrum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">erv</span>
                <span class="n">watvap_coeff</span> <span class="o">=</span> <span class="n">water_vapor_coeff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">ozone_absorb_coeff</span> <span class="o">=</span> <span class="n">ozone_absorbtion_coeff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">unif_mix_gas_ab_coeff</span> <span class="o">=</span> <span class="n">uniformly_mixed_gas_absorbtion_coeff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                <span class="n">omegl</span> <span class="o">=</span> <span class="n">omeg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">omegp</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">wvl</span> <span class="o">/</span> <span class="mf">0.4</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">wvl</span> <span class="o">/</span> <span class="mf">0.4</span><span class="p">)))</span>
                <span class="n">c1</span> <span class="o">=</span> <span class="n">tau500</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">wvl</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="n">alpha</span><span class="p">)</span>

                <span class="c1"># Equation 2-4</span>
                <span class="n">Tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">ampress</span> <span class="o">/</span> <span class="p">((</span><span class="n">wvl</span> <span class="o">*</span> <span class="n">wvl</span> <span class="o">*</span> <span class="n">wvl</span> <span class="o">*</span> <span class="n">wvl</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">115.6406</span> <span class="o">-</span> <span class="mf">1.3366</span> <span class="o">/</span> <span class="p">(</span><span class="n">wvl</span> <span class="o">*</span> <span class="n">wvl</span><span class="p">))))</span>
                <span class="c1"># Equation 2-9</span>
                <span class="n">To</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">ozone_absorb_coeff</span> <span class="o">*</span> <span class="n">O3</span> <span class="o">*</span> <span class="n">ozone_mass</span><span class="p">)</span>
                <span class="c1"># Equation 2-8</span>
                <span class="n">Tw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                    <span class="o">-</span><span class="mf">0.2385</span> <span class="o">*</span> <span class="n">watvap_coeff</span> <span class="o">*</span> <span class="n">watvap</span> <span class="o">*</span> <span class="n">ampress</span> <span class="o">/</span> <span class="nb">pow</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">20.07</span> <span class="o">*</span> <span class="n">watvap_coeff</span> <span class="o">*</span> <span class="n">watvap</span> <span class="o">*</span> <span class="n">ampress</span><span class="p">),</span>
                                                                    <span class="mf">0.45</span><span class="p">))</span>
                <span class="c1"># Equation 2-11</span>
                <span class="n">Tu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                    <span class="o">-</span><span class="mf">1.41</span> <span class="o">*</span> <span class="n">unif_mix_gas_ab_coeff</span> <span class="o">*</span> <span class="n">ampress</span> <span class="o">/</span> <span class="nb">pow</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">118.3</span> <span class="o">*</span> <span class="n">unif_mix_gas_ab_coeff</span> <span class="o">*</span> <span class="n">ampress</span><span class="p">),</span>
                                                                  <span class="mf">0.45</span><span class="p">))</span>
                <span class="c1"># Equation 3-9</span>
                <span class="n">Tas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">omegl</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">ampress</span><span class="p">)</span>
                <span class="c1"># Equation 3-10</span>
                <span class="n">Taa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">omegl</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">ampress</span><span class="p">)</span>
                <span class="c1"># Equation 2-6, sort of</span>
                <span class="n">Ta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span> <span class="o">*</span> <span class="n">ampress</span><span class="p">)</span>
                <span class="c1"># Equation 2-4 primed airmass M = 1.8 (Section 3.1)</span>
                <span class="n">Trp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.8</span> <span class="o">/</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">wvl</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">115.6406</span> <span class="o">-</span> <span class="mf">1.3366</span> <span class="o">/</span> <span class="p">(</span><span class="n">wvl</span> <span class="o">*</span> <span class="n">wvl</span><span class="p">))))</span>
                <span class="c1"># Equation 2-8 primed airmass M = 1.8 (Section 3.1) affects coefficients</span>
                <span class="n">Twp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4293</span> <span class="o">*</span> <span class="n">watvap_coeff</span> <span class="o">*</span> <span class="n">watvap</span> <span class="o">/</span> <span class="nb">pow</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">36.126</span> <span class="o">*</span> <span class="n">watvap_coeff</span> <span class="o">*</span> <span class="n">watvap</span><span class="p">),</span> <span class="mf">0.45</span><span class="p">))</span>
                <span class="c1"># Equation 2-11 primed airmass M = 1.8 (Section 3.1) affects coefficients</span>
                <span class="n">Tup</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.538</span> <span class="o">*</span> <span class="n">unif_mix_gas_ab_coeff</span> <span class="o">/</span> <span class="nb">pow</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">212.94</span> <span class="o">*</span> <span class="n">unif_mix_gas_ab_coeff</span><span class="p">),</span> <span class="mf">0.45</span><span class="p">))</span>
                <span class="c1"># Equation 3-9 primed airmass M = 1.8 (Section 3.1)</span>
                <span class="n">Tasp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">omegl</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">*</span> <span class="mf">1.8</span><span class="p">)</span>
                <span class="c1"># Equation 3-10 primed airmass M = 1.8 (Section 3.1)</span>
                <span class="n">Taap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">omegl</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">c1</span> <span class="o">*</span> <span class="mf">1.8</span><span class="p">)</span>
                <span class="c1"># ........... Direct energy .............</span>
                <span class="c1"># Temporary variable</span>
                <span class="n">c2</span> <span class="o">=</span> <span class="n">etr</span> <span class="o">*</span> <span class="n">To</span> <span class="o">*</span> <span class="n">Tw</span> <span class="o">*</span> <span class="n">Tu</span>
                <span class="c1"># Equation 2-1</span>
                <span class="nb">dir</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Ta</span>

                <span class="c1"># ........... Diffuse energy .............</span>
                <span class="c1"># Temporary variables</span>
                <span class="n">c2</span> <span class="o">*=</span> <span class="n">cz</span> <span class="o">*</span> <span class="n">Taa</span>

                <span class="c1"># I think this is equivalent.</span>
                <span class="n">nr</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wvlrefl</span><span class="p">)</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;=</span> <span class="n">wvl</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

                <span class="c1"># if wvl &gt; wvlrefl[nr]:</span>
                <span class="c1">#     nr += 1</span>

                <span class="n">c3</span> <span class="o">=</span> <span class="p">(</span><span class="n">refl</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">-</span> <span class="n">refl</span><span class="p">[</span><span class="n">nr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">wvlrefl</span><span class="p">[</span><span class="n">nr</span><span class="p">]</span> <span class="o">-</span> <span class="n">wvlrefl</span><span class="p">[</span><span class="n">nr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="c1"># Equation 3-17 c4 = Cs</span>
                <span class="n">c4</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">wvl</span> <span class="o">&gt;</span> <span class="mf">0.45</span> <span class="k">else</span> <span class="nb">pow</span><span class="p">((</span><span class="n">wvl</span> <span class="o">+</span> <span class="mf">0.55</span><span class="p">),</span> <span class="mf">1.8</span><span class="p">)</span>
                <span class="c1"># Equation 3-8</span>
                <span class="n">rhoa</span> <span class="o">=</span> <span class="n">Tup</span> <span class="o">*</span> <span class="n">Twp</span> <span class="o">*</span> <span class="n">Taap</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">Trp</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">fsp</span><span class="p">)</span> <span class="o">*</span> <span class="n">Trp</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">Tasp</span><span class="p">))</span>
                <span class="c1"># Interpolated ground reflectivity</span>
                <span class="n">rho</span> <span class="o">=</span> <span class="n">c3</span> <span class="o">*</span> <span class="p">(</span><span class="n">wvl</span> <span class="o">-</span> <span class="n">wvlrefl</span><span class="p">[</span><span class="n">nr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">refl</span><span class="p">[</span><span class="n">nr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="c1"># Equation 3-5</span>
                <span class="n">dray</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="nb">pow</span><span class="p">(</span><span class="n">Tr</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">))</span> <span class="o">/</span> <span class="mf">2.0</span>
                <span class="c1"># Equation 3-6</span>
                <span class="n">daer</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">Tr</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">Tas</span><span class="p">)</span> <span class="o">*</span> <span class="n">fs</span>
                <span class="c1"># Equation 3-7</span>
                <span class="n">drgd</span> <span class="o">=</span> <span class="p">(</span><span class="nb">dir</span> <span class="o">*</span> <span class="n">cz</span> <span class="o">+</span> <span class="n">dray</span> <span class="o">+</span> <span class="n">daer</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">rhoa</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">rhoa</span><span class="p">)</span>
                <span class="c1"># Equation 3-1</span>
                <span class="n">dif</span> <span class="o">=</span> <span class="p">(</span><span class="n">dray</span> <span class="o">+</span> <span class="n">daer</span> <span class="o">+</span> <span class="n">drgd</span><span class="p">)</span> <span class="o">*</span> <span class="n">c4</span>

                <span class="c1"># ........... Global (total) energy .............</span>
                <span class="n">dtot</span> <span class="o">=</span> <span class="nb">dir</span> <span class="o">*</span> <span class="n">cz</span> <span class="o">+</span> <span class="n">dif</span>

                <span class="c1"># ........... Tilt energy, if applicable</span>
                <span class="k">if</span> <span class="n">tilt</span> <span class="o">&gt;</span> <span class="mf">1.0e-4</span><span class="p">:</span>
                    <span class="c1"># Equation 3-18 without the first (direct-beam) term</span>
                    <span class="n">c1</span> <span class="o">=</span> <span class="n">dtot</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">ct</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
                    <span class="n">c2</span> <span class="o">=</span> <span class="nb">dir</span> <span class="o">/</span> <span class="n">etr</span>
                    <span class="n">c3</span> <span class="o">=</span> <span class="n">dif</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">ci</span> <span class="o">/</span> <span class="n">cz</span>
                    <span class="n">c4</span> <span class="o">=</span> <span class="n">dif</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">c2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">ct</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
                    <span class="n">dif</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c3</span> <span class="o">+</span> <span class="n">c4</span>
                    <span class="c1"># Equation 3-18, including first term</span>
                    <span class="n">dtot</span> <span class="o">=</span> <span class="nb">dir</span> <span class="o">*</span> <span class="n">ci</span> <span class="o">+</span> <span class="n">dif</span>
                <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="nb">dir</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="n">dif</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dif</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="nb">dir</span> <span class="o">=</span> <span class="nb">dir</span> <span class="k">if</span> <span class="nb">dir</span> <span class="o">&gt;</span> <span class="n">etr</span> <span class="k">else</span> <span class="nb">dir</span>
                    <span class="n">dif</span> <span class="o">=</span> <span class="nb">dir</span> <span class="k">if</span> <span class="n">dif</span> <span class="o">&gt;</span> <span class="n">etr</span> <span class="k">else</span> <span class="n">dif</span>
                    <span class="n">spec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">wvl</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="nb">dir</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">etr</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">dif</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">dir</span> <span class="o">*</span> <span class="n">dif</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">c1</span> <span class="o">=</span> <span class="n">wvl</span> <span class="o">*</span> <span class="n">cons</span>
                    <span class="n">spx</span> <span class="o">=</span> <span class="n">wvl</span>
                    <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">spx</span> <span class="o">=</span> <span class="n">e</span> <span class="o">/</span> <span class="n">wvl</span>
                        <span class="n">c1</span> <span class="o">*=</span> <span class="n">wvl</span> <span class="o">/</span> <span class="n">spx</span>
                    <span class="n">spec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">spx</span><span class="p">,</span> <span class="nb">dir</span> <span class="o">*</span> <span class="n">c1</span><span class="p">,</span> <span class="n">etr</span><span class="p">,</span> <span class="n">dif</span> <span class="o">*</span> <span class="n">c1</span><span class="p">,</span> <span class="n">dtot</span> <span class="o">*</span> <span class="n">c1</span>

                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">specxdelta</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">spec</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

                <span class="c1"># direct integration</span>
                <span class="n">integration</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">specxdelta</span> <span class="o">*</span> <span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">spec</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
                <span class="c1"># diffuse integration</span>
                <span class="n">integration</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">specxdelta</span> <span class="o">*</span> <span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">spec</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
                <span class="c1"># Sum individual wavelength contributions to the spectra:</span>
                <span class="c1"># total integrated solar irradiance (specdat.specglo)</span>
                <span class="n">integration</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">specxdelta</span> <span class="o">*</span> <span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="n">spec</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

                <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">group</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">group</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
                        <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">max</span><span class="p">(</span><span class="n">integration</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">specxdelta</span> <span class="o">*</span> <span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">spec</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
                        <span class="n">group</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">group</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">shadingmultiplier</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">groups</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">groups</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">groups</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
            <span class="c1"># these probably arent needed.</span>
            <span class="n">totdirect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">integration</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">totdiffuse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">integration</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="c1"># this is actually in the code somewhere but is more cryptic</span>
            <span class="c1"># it increments a variable called localTotalSun and then sets the value in Solarcalc (sc.trad)</span>
            <span class="c1"># to it and does this calc.</span>
            <span class="n">trad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">integration</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
            <span class="n">totvis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">integration</span><span class="p">[</span><span class="mi">14</span><span class="p">:</span><span class="mi">55</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
            <span class="n">integration</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">/=</span> <span class="p">(</span><span class="n">solar_irradiance</span> <span class="o">*</span> <span class="n">trad</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">spec</span><span class="p">,</span> <span class="n">integration</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">trad</span><span class="p">,</span> <span class="n">totvis</span></div>


<div class="viewcode-block" id="Spectra.spectral2"><a class="viewcode-back" href="../light_sim.html#Spectra.Spectra.spectral2">[docs]</a>    <span class="k">def</span> <span class="nf">spectral2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solar_irradiance</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Should operate in the same way as SolarCalc/spectral.java:L25: S_spectral2</span>

<span class="sd">        :param solar_irradiance: solar irradiance to drive calculation from</span>
<span class="sd">        :return: numpy array of spectrum and integrated spectral radiation</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">spec</span><span class="p">,</span> <span class="n">integration</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">trad</span><span class="p">,</span> <span class="n">totvis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_all_spectral</span><span class="p">(</span><span class="n">solar_irradiance</span><span class="p">)</span>
        <span class="c1"># return matching wavelengths and their intensities, wl=spec[:,0], global irradiance=spec[:,4]</span>
        <span class="k">return</span> <span class="n">spec</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span></div>

<div class="viewcode-block" id="Spectra.calcLEDIntensity"><a class="viewcode-back" href="../light_sim.html#Spectra.Spectra.calcLEDIntensity">[docs]</a>    <span class="k">def</span> <span class="nf">calcLEDIntensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">intensity_total</span><span class="p">,</span> <span class="n">intensity_max</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="c1"># inttotal should be just integration[:,2]</span>
        <span class="n">ledref</span> <span class="o">=</span> <span class="n">intensity_max</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">ledref</span> <span class="o">=</span> <span class="n">intensity_total</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>


<div class="viewcode-block" id="Spectra.calc_leds"><a class="viewcode-back" href="../light_sim.html#Spectra.Spectra.calc_leds">[docs]</a>    <span class="k">def</span> <span class="nf">calc_leds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solar_irradiance</span><span class="p">,</span>
                  <span class="n">total_solar_irradiance_daily_max</span><span class="p">,</span>
                  <span class="n">total_integrated_solar_irradiance_max</span><span class="p">):</span>

        <span class="n">spec</span><span class="p">,</span> <span class="n">integration</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">trad</span><span class="p">,</span> <span class="n">totvis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_all_spectral</span><span class="p">(</span><span class="n">solar_irradiance</span><span class="p">)</span>
        <span class="n">trad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">integration</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>

        <span class="n">trad_maxtoday</span> <span class="o">=</span> <span class="n">total_integrated_solar_irradiance_max</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dayofyear</span><span class="p">]</span>
        <span class="n">st_maxtoday</span> <span class="o">=</span> <span class="n">total_solar_irradiance_daily_max</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dayofyear</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">trad_maxtoday</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">solar_irradiance</span> <span class="o">=</span> <span class="n">trad</span> <span class="o">/</span> <span class="n">trad_maxtoday</span> <span class="o">*</span> <span class="n">st_maxtoday</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">solar_irradiance</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">solar_irradiance</span> <span class="o">/</span> <span class="n">SPO</span> <span class="o">*</span> <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="n">incandescent_conviron</span> <span class="o">=</span> <span class="n">solar_irradiance</span> <span class="o">/</span> <span class="n">SPO</span>
        <span class="n">incandescent_conviron</span> <span class="o">=</span> <span class="n">ONEMINUSEPSILON</span> <span class="k">if</span> <span class="n">incandescent_conviron</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">incandescent_conviron</span>
        <span class="n">fluro_conviron</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">spec</span><span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">totvis</span> <span class="o">*</span> <span class="n">group</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span></div></div>


</pre></div>

          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2016, Kurt Spokas, Gareth Dunstone.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>